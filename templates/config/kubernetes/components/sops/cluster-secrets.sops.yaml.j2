---
apiVersion: v1
kind: Secret
metadata:
  name: cluster-secrets
stringData:
  SECRET_DOMAIN: "#{ primary_domain }#"
#% for domain in cloudflare_domains %#
  SECRET_DOMAIN_#{ loop.index }#: "#{ domain }#"
#% endfor %#
#|
  Obot secrets for Flux substitution
  Used by: kubernetes/apps/obot/obot/app/helmrelease.yaml
#|
#% if obot_enabled | default(false) %#
  OBOT_DB_PASSWORD: "#{ obot_postgres_password }#"
#% if obot_cookie_secret | default('') %#
  OBOT_COOKIE_SECRET: "#{ obot_cookie_secret }#"
#% endif %#
#% if obot_encryption_key | default('') %#
  OBOT_SERVER_ENCRYPTION_KEY: "#{ obot_encryption_key }#"
#% endif %#
#% if obot_bootstrap_token | default('') %#
  OBOT_BOOTSTRAP_TOKEN: "#{ obot_bootstrap_token }#"
#% endif %#
#% if obot_entra_client_id | default('') %#
  OBOT_ENTRA_CLIENT_ID: "#{ obot_entra_client_id }#"
#% endif %#
#% if obot_entra_client_secret | default('') %#
  OBOT_ENTRA_CLIENT_SECRET: "#{ obot_entra_client_secret }#"
#% endif %#
#% if obot_keycloak_enabled | default(false) and obot_keycloak_client_secret | default('') %#
  OBOT_KEYCLOAK_CLIENT_SECRET: "#{ obot_keycloak_client_secret }#"
#% endif %#
#% if obot_workspace_provider | default('directory') == 's3' and obot_s3_access_key | default('') %#
  OBOT_S3_ACCESS_KEY: "#{ obot_s3_access_key }#"
  OBOT_S3_SECRET_KEY: "#{ obot_s3_secret_key }#"
#% endif %#
#% endif %#
#|
  UniFi Poller secrets for env var injection
  Used by: kubernetes/apps/observability/unpoller/app/helmrelease.yaml
#|
#% if unifi_enabled | default(false) %#
  UP_UNIFI_DEFAULT_URL: "#{ unifi_url }#"
  UP_UNIFI_DEFAULT_USER: "#{ unifi_user }#"
  UP_UNIFI_DEFAULT_PASS: "#{ unifi_pass }#"
#% endif %#
