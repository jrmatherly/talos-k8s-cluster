#% if flux_web_enabled | default(false) and flux_web_oauth2_enabled | default(true) %#
---
#| ClusterRole for Flux Web UI - read-only access to all cluster resources #|
#| Per docs: https://fluxoperator.dev/docs/web-ui/user-management/ #|
#| The Web UI is strictly read-only and needs access to all resources #|
#| to display workloads, events, and related Kubernetes objects #|
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: flux-web-view
rules:
  - apiGroups: ["*"]
    resources: ["*"]
    verbs: ["get", "list", "watch"]
---
#| ClusterRoleBinding for all authenticated Flux Web UI users #|
#| cluster-admins, developers, and viewers all get read-only access #|
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: flux-web-view-binding
subjects:
  - kind: Group
    name: cluster-admins
    apiGroup: rbac.authorization.k8s.io
  - kind: Group
    name: developers
    apiGroup: rbac.authorization.k8s.io
  - kind: Group
    name: viewers
    apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: flux-web-view
  apiGroup: rbac.authorization.k8s.io
#% endif %#