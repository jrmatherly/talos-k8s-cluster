#% if traceloop_enabled and traceloop_hub_enabled %#
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: traceloop-hub-config
data:
  config.yaml: |
    general:
      trace_content_enabled: true

    providers:
      #% if azure_openai_us_east_api_key and azure_openai_us_east_resource_name %#
      # Azure OpenAI - US East Region
      - key: azure-openai-us-east
        type: azure
        api_key: ${AZURE_OPENAI_US_EAST_API_KEY}
        resource_name: #{ azure_openai_us_east_resource_name }#
        api_version: "2024-10-21"
      #% endif %#

      #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
      # Azure OpenAI - US East2 Region
      - key: azure-openai-us-east2
        type: azure
        api_key: ${AZURE_OPENAI_US_EAST2_API_KEY}
        resource_name: #{ azure_openai_us_east2_resource_name }#
        api_version: "2024-10-21"
      #% endif %#

      #% if traceloop_openai_api_key is defined and traceloop_openai_api_key %#
      # OpenAI Direct
      - key: openai
        type: openai
        api_key: ${OPENAI_API_KEY}
      #% endif %#

      #% if traceloop_anthropic_api_key is defined and traceloop_anthropic_api_key %#
      # Anthropic Direct
      - key: anthropic
        type: anthropic
        api_key: ${ANTHROPIC_API_KEY}
      #% endif %#

    models:
      #% if azure_openai_us_east_api_key and azure_openai_us_east_resource_name %#
      # Azure OpenAI US East Models - Chat
      - key: gpt-4.1
        type: gpt-4.1
        provider: azure-openai-us-east
        deployment: gpt-4.1
      - key: gpt-4.1-nano
        type: gpt-4.1-nano
        provider: azure-openai-us-east
        deployment: gpt-4.1-nano
      - key: gpt-4o-mini
        type: gpt-4o-mini
        provider: azure-openai-us-east
        deployment: gpt-4o-mini
      # Azure OpenAI US East Models - Reasoning
      - key: o3
        type: o3
        provider: azure-openai-us-east
        deployment: o3
      - key: o4-mini
        type: o4-mini
        provider: azure-openai-us-east
        deployment: o4-mini
      # Azure OpenAI US East Models - Embeddings
      - key: text-embedding-3-small
        type: text-embedding-3-small
        provider: azure-openai-us-east
        deployment: text-embedding-3-small
      - key: text-embedding-ada-002
        type: text-embedding-ada-002
        provider: azure-openai-us-east
        deployment: text-embedding-ada-002
      #% endif %#

      #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
      # Azure OpenAI US East2 Models - Chat
      - key: gpt-5
        type: gpt-5
        provider: azure-openai-us-east2
        deployment: gpt-5
      - key: gpt-5-nano
        type: gpt-5-nano
        provider: azure-openai-us-east2
        deployment: gpt-5-nano
      - key: gpt-5-mini
        type: gpt-5-mini
        provider: azure-openai-us-east2
        deployment: gpt-5-mini
      - key: gpt-5.1
        type: gpt-5.1
        provider: azure-openai-us-east2
        deployment: gpt-5.1
      # Azure OpenAI US East2 Models - Thinking
      - key: gpt-5-chat
        type: gpt-5-chat
        provider: azure-openai-us-east2
        deployment: gpt-5-chat
      - key: gpt-5.1-chat
        type: gpt-5.1-chat
        provider: azure-openai-us-east2
        deployment: gpt-5.1-chat
      # Azure OpenAI US East2 Models - Codex
      - key: gpt-5.1-codex
        type: gpt-5.1-codex
        provider: azure-openai-us-east2
        deployment: gpt-5.1-codex
      - key: gpt-5.1-codex-mini
        type: gpt-5.1-codex-mini
        provider: azure-openai-us-east2
        deployment: gpt-5.1-codex-mini
      # Azure OpenAI US East2 Models - Embeddings
      - key: text-embedding-3-large
        type: text-embedding-3-large
        provider: azure-openai-us-east2
        deployment: text-embedding-3-large
      #% endif %#

      #% if traceloop_openai_api_key is defined and traceloop_openai_api_key %#
      # OpenAI Direct Models
      - key: gpt-4-turbo
        type: gpt-4-turbo
        provider: openai
      - key: gpt-3.5-turbo
        type: gpt-3.5-turbo
        provider: openai
      #% endif %#

      #% if traceloop_anthropic_api_key is defined and traceloop_anthropic_api_key %#
      # Anthropic Direct Models
      - key: claude-3-5-sonnet
        type: claude-3-5-sonnet-20241022
        provider: anthropic
      - key: claude-3-opus
        type: claude-3-opus-20240229
        provider: anthropic
      - key: claude-3-haiku
        type: claude-3-haiku-20240307
        provider: anthropic
      #% endif %#

    pipelines:
      # Default chat pipeline
      - name: default
        type: chat
        plugins:
          - logging:
              level: info
          - model-router:
              models:
                #% if azure_openai_us_east_api_key and azure_openai_us_east_resource_name %#
                - gpt-4.1
                - gpt-4.1-nano
                - gpt-4o-mini
                #% endif %#
                #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
                - gpt-5
                - gpt-5-nano
                - gpt-5-mini
                - gpt-5.1
                #% endif %#
                #% if traceloop_openai_api_key is defined and traceloop_openai_api_key %#
                - gpt-4-turbo
                - gpt-3.5-turbo
                #% endif %#
                #% if traceloop_anthropic_api_key is defined and traceloop_anthropic_api_key %#
                - claude-3-5-sonnet
                - claude-3-opus
                - claude-3-haiku
                #% endif %#

      # Reasoning pipeline (extended timeouts handled at gateway level)
      - name: reasoning
        type: chat
        plugins:
          - logging:
              level: info
          - model-router:
              models:
                #% if azure_openai_us_east_api_key and azure_openai_us_east_resource_name %#
                - o3
                - o4-mini
                #% endif %#
                #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
                - gpt-5-chat
                - gpt-5.1-chat
                #% endif %#

      # Codex pipeline
      - name: codex
        type: chat
        plugins:
          - logging:
              level: info
          - model-router:
              models:
                #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
                - gpt-5.1-codex
                - gpt-5.1-codex-mini
                #% endif %#

      # Embeddings pipeline
      - name: embeddings
        type: embeddings
        plugins:
          - model-router:
              models:
                #% if azure_openai_us_east_api_key and azure_openai_us_east_resource_name %#
                - text-embedding-3-small
                - text-embedding-ada-002
                #% endif %#
                #% if azure_openai_us_east2_api_key and azure_openai_us_east2_resource_name %#
                - text-embedding-3-large
                #% endif %#
#% endif %#
