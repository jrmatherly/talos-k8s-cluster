#| Keycloak admin, database, and IdP credentials #|
#| Encrypted with SOPS/age #|
#% if mcp_gateway_enabled %#
---
#| Database credentials - mirrors CNPG credentials in database namespace #|
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-db-credentials
  labels:
    app: keycloak
    app.kubernetes.io/name: keycloak
    app.kubernetes.io/component: database-credentials
    app.kubernetes.io/part-of: mcp-gateway
type: Opaque
stringData:
  username: keycloak
  password: #{ keycloak_postgres_password }#
---
#| Admin credentials #|
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-admin-secret
  labels:
    app: keycloak
    app.kubernetes.io/name: keycloak
    app.kubernetes.io/component: authorization-server
    app.kubernetes.io/part-of: mcp-gateway
type: Opaque
stringData:
  username: admin
  password: #{ keycloak_admin_password }#
---
#| Identity Provider secrets for Keycloak federation #|
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-idp-secrets
  labels:
    app: keycloak
    app.kubernetes.io/name: keycloak
    app.kubernetes.io/component: idp-credentials
    app.kubernetes.io/part-of: mcp-gateway
type: Opaque
stringData:
#% if oidc_entra_enabled %#
  entra-client-id: #{ oidc_entra_client_id }#
  entra-client-secret: #{ oidc_entra_client_secret }#
#% endif %#
#% if oidc_google_enabled %#
  google-client-id: #{ oidc_google_client_id }#
  google-client-secret: #{ oidc_google_client_secret }#
#% endif %#
#% if oidc_github_enabled %#
  github-client-id: #{ oidc_github_client_id }#
  github-client-secret: #{ oidc_github_client_secret }#
#% endif %#
#% endif %#
