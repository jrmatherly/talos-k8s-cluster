#% if cognee_enabled | default(false) and cognee_api_enabled | default(false) %#
---
apiVersion: v1
kind: Secret
metadata:
  name: cognee-api-secrets
type: Opaque
stringData:
  # Database credentials
  DB_PASSWORD: "#{ cognee_db_password if cognee_dedicated_db | default(false) else obot_postgres_password }#"
  MIGRATION_DB_PASSWORD: "#{ cognee_db_password if cognee_dedicated_db | default(false) else obot_postgres_password }#"
#% if cognee_dedicated_db | default(false) %#
  COGNEE_DB_DSN: "postgresql://cognee:#{ cognee_db_password }#@cognee-db-rw.ai-system.svc.cluster.local:5432/#{ cognee_db_name | default('cognee') }#"
#% else %#
  COGNEE_DB_DSN: "postgresql://obot:#{ obot_postgres_password }#@obot-db-rw.obot.svc.cluster.local:5432/#{ cognee_db_name | default('cognee') }#"
#% endif %#

  # Neo4j credentials
  GRAPH_DATABASE_PASSWORD: "#{ cognee_neo4j_password }#"

  #############################################################################
  # JWT Security (REQUIRED - v0.5.2+)
  # Generate secrets with: python -c "import secrets; print(secrets.token_urlsafe(64))"
  # These must be at least 32 characters and NOT weak defaults like "super_secret"
  #############################################################################
  FASTAPI_USERS_JWT_SECRET: "#{ cognee_jwt_secret }#"
  FASTAPI_USERS_RESET_PASSWORD_TOKEN_SECRET: "#{ cognee_reset_password_token_secret | default(cognee_jwt_secret) }#"
  FASTAPI_USERS_VERIFICATION_TOKEN_SECRET: "#{ cognee_verification_token_secret | default(cognee_jwt_secret) }#"

#% if cognee_oidc_enabled | default(false) %#
  #############################################################################
  # OIDC/Keycloak Authentication
  #############################################################################
  OIDC_CLIENT_ID: "#{ cognee_oidc_client_id }#"
  OIDC_CLIENT_SECRET: "#{ cognee_oidc_client_secret }#"
#% endif %#

  # LLM API key - Use cognee_litellm_api_key for LLM proxy access
  # Falls back to litellm_master_key if not specified
#% if cognee_litellm_api_key | default('') %#
  LLM_API_KEY: "#{ cognee_litellm_api_key }#"
  EMBEDDING_API_KEY: "#{ cognee_litellm_api_key }#"
#% elif litellm_master_key | default('') %#
  LLM_API_KEY: "#{ litellm_master_key }#"
  EMBEDDING_API_KEY: "#{ litellm_master_key }#"
#% else %#
  # Fallback to Azure OpenAI key if no LiteLLM key configured
  LLM_API_KEY: "#{ azure_openai_api_key_us_east | default('') }#"
  EMBEDDING_API_KEY: "#{ azure_openai_api_key_us_east | default('') }#"
#% endif %#
#% endif %#
