#% if agentgateway_addr is defined and azure_openai_eastus2_api_key is defined and azure_openai_eastus2_realtime_deployment_name is defined %#
---
#| Backend for Azure OpenAI (kgateway v2.1.1) #|
#| Realtime uses different URL pattern: /openai/realtime?deployment=... #|
apiVersion: gateway.kgateway.dev/v1alpha1
kind: Backend
metadata:
  name: azure-openai-eastus2-realtime
  labels:
    cost-center: ai-gateway
    provider: azure-openai
    region: eastus2
    model-type: realtime
    app.kubernetes.io/name: azure-openai-eastus2-realtime
    app.kubernetes.io/component: ai-backend
    app.kubernetes.io/part-of: ai-system
spec:
  type: AI
  ai:
    llm:
      azureopenai:
        endpoint: "https://#{ azure_openai_eastus2_resource_name }#.openai.azure.com"
        deploymentName: "#{ azure_openai_eastus2_realtime_deployment_name }#"
        apiVersion: "#{ azure_openai_eastus2_realtime_api_version | default('2024-10-01-preview') }#"
        authToken:
          kind: SecretRef
          secretRef:
            name: azure-openai-eastus2-realtime-credentials
#% endif %#
