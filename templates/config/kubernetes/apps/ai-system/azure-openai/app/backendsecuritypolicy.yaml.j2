#% if envoy_ai_gateway_enabled and azure_openai_api_key %#
---
# Backend Security Policy for Azure OpenAI authentication
apiVersion: aigateway.envoyproxy.io/v1alpha1
kind: BackendSecurityPolicy
metadata:
  name: azure-openai-auth
spec:
  targetRefs:
    - group: aigateway.envoyproxy.io
      kind: AIServiceBackend
      name: azure-openai
#% if azure_tenant_id and azure_client_id %#
  type: AzureCredentials
  azureCredentials:
    clientID: "#{ azure_client_id }#"
    tenantID: "#{ azure_tenant_id }#"
    clientSecretRef:
      name: azure-credentials
#% else %#
  type: AzureAPIKey
  azureAPIKey:
    secretRef:
      name: azure-openai-credentials
#% endif %#
#% endif %#
