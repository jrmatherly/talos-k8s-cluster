---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: kubernetes-event-exporter
spec:
  chart:
    spec:
      chart: kubernetes-event-exporter
      version: "3.6.3"
      sourceRef:
        kind: HelmRepository
        name: bitnami
  interval: 1h
  values:
    image:
      registry: ghcr.io
      repository: resmoio/kubernetes-event-exporter
      tag: v1.7
    podLabels:
      network.cilium.io/api-access: "true"
    config:
      leaderElection: {}
      logLevel: info
      logFormat: json
      metricsNamePrefix: event_exporter_
      receivers:
        - name: "victorialogs"
          loki:
            url: "http://victoria-logs-server.observability.svc.cluster.local:9428/insert/loki/api/v1/push"
            streamLabels:
              source_type: kubernetes-event
      route:
        routes:
          - match:
              - receiver: "victorialogs"
    resources:
      requests:
        cpu: "50m"
        memory: "64Mi"
      limits:
        cpu: "200m"
        memory: "256Mi"
